# Учет финансов 

## DI контейнер
DI контейнер находится в статичном классе DIConfig

p.s Для работы контейнера необходимо установить расширение Microsoft.Extensions.DependencyInjection.

## Реализованный функционал:

- ### Управление счетами:

    Создание счета (с указанием имени).

    Удаление счета (по ID).

    Изменение имени счета (по ID).

    Пополнение счета (по ID, с указанием суммы).

    Списание средств со счета (по ID, с указанием суммы).

    Отображение списка всех счетов (ID, имя, баланс).

- ### Управление категориями:

    Создание категории (с указанием типа операции - доход/расход, и имени).
    
    Удаление категории (по ID).
    
    Изменение имени категории (по ID).
    
    Изменение типа категории (по ID).
    
    Отображение списка всех категорий.

- ### Управление операциями:

    Создание операции (с указанием типа, ID счета, суммы, даты, ID категории и описания).
    
    Удаление операции (по ID).
    
    Изменение всех полей операции (по ID).
    
    Отображение списка всех операций.

- ### Импорт/Экспорт данных:

    Импорт данных о счетах, категориях и операциях из файлов формата JSON, CSV и YAML.
    
    Экспорт данных о счетах, категориях и операциях в файлы формата JSON, CSV и YAML.

- ### Аналитика:

    Расчет разницы между доходами и расходами за указанный период для конкретного счета.
    
    Группировка операций по категориям и типам (доход/расход) за указанный период для конкретного счета.

- ### Перерасчет баланса:

    Пересчет баланса для конкретного счета
    
    Пересчет балансов для всех счетов

- ### Измерение времени:

    Измерение времени выполнения каждой команды.
    
    Сохранение и вывод средней продолжительности выполнения команд по сценариям.

## Принципы SOLID:

### Single Responsibility Principle (SRP):

- Каждый класс имеет одну четко определенную ответственность.

  Account: Управление данными счета (имя, баланс, ID).
        
  AccountService: Бизнес-логика для управления счетами (добавление, удаление, изменение).
        
  Category, CategoryService: Аналогично для категорий.
        
  Operation, OperationService: Аналогично для операций.
        
  *Facade (AccountFacade, CategoryFacade, OperationFacade, AnalyticFacade): Предоставляет высокоуровневый интерфейс для работы с соответствующими сервисами.
        
  *Command классы: Инкапсулируют отдельные действия (команды) над объектами.
        
  *Importer, *ExportVisitor: Реализации для импорта и экспорта в разных форматах.
        
  AnaliticService: Бизнес-логика для выполнения аналитических запросов.

### Open/Closed Principle (OCP):

- Классы импорта и экспорта данных (DataImporter<T>, IExportVisitor<T>) открыты для расширения (можно добавить новые форматы), но закрыты для изменения.

- Классы команд (*Command) позволяют добавлять новые операции без изменения существующих сервисов.

### Liskov Substitution Principle (LSP):

- Базовый класс DataImporter<T> и его наследники (JsonImporter<T>, YamlImporter<T>, CsvImporter<T>) взаимозаменяемы.

- Интерфейс IExportVisitor<T> и его реализации (JsonExportVisitor<T>, YamlExportVisitor<T>, CsvExportVisitor<T>) взаимозаменяемы.

- Интерфейс ICommand и его реализации (*Command) взаимозаменяемы.

### Interface Segregation Principle (ISP):

- Использовано несколько интерфейсов вместо одного "толстого":
        
  ICommand: Общий интерфейс для всех команд.
        
  IAccountCommandFactory, ICategoryCommandFactory, IOperationCommandFactory: Раздельные фабрики команд для счетов, категорий и операций.
        
  IExportVisitor<T>: Для экспорта данных.

### Dependency Inversion Principle (DIP):

- Высокоуровневые модули (фасады) не зависят от низкоуровневых (сервисы). Используется инъекция зависимостей через конструкторы.

  AccountFacade зависит от абстракций AccountService и IAccountCommandFactory, а не от конкретных реализаций.
        
  AnalyticFacade зависит от абстракции AnaliticService.

- Аналогично для CategoryFacade и OperationFacade.

  Сервисы (AccountService, CategoryService, OperationService) зависят от абстракции DataImporter<T> и IExportVisitor<T> для импорта/экспорта.

## Принципы GRASP:

### Controller:

- Фасады (AccountFacade, CategoryFacade, OperationFacade, AnaliticFacade) действуют как контроллеры, принимая запросы от пользователя и делегируя их соответствующим сервисам и командам.

### Low Coupling:

- Слабая связанность между модулями достигается за счет использования интерфейсов, инъекции зависимостей и паттерна Command. Это позволяет изменять одни части системы, не затрагивая другие.

- Фасады скрывают сложность внутренней реализации.

### High Cohesion:

- Высокая связность внутри модулей. Каждый класс и модуль выполняет четко определенный набор функций. Например, AccountService отвечает только за управление счетами.

### Polymorphism:

- Используется для реализации импорта/экспорта данных (полиморфное поведение DataImporter<T> и IExportVisitor<T>).

- Используется для выполнения команд (полиморфное поведение ICommand).

### Protected Variations:

- Защита от изменений в реализации импорта/экспорта с помощью интерфейсов DataImporter<T> и IExportVisitor<T>.

- Защита от изменений в реализации команд с помощью интерфейса ICommand.

## Паттерны GoF:
### Command:

- Обоснование: Инкапсулирует запрос как объект, позволяя параметризовать клиентов с разными запросами, ставить запросы в очередь, логировать их, а также поддерживать отмену операций. Упрощает добавление новых операций без изменения существующих классов.

- Реализация: Интерфейс ICommand и конкретные классы команд (AddAccountCommand, RemoveAccountCommand, ChangeAccountNameCommand и т.д.).

### Factory Method:

- Обоснование: Определяет интерфейс для создания объектов, но позволяет подклассам решать, какой класс инстанцировать. Делегирует создание объектов подклассам.

- Реализация: IAccountCommandFactory, ICategoryCommandFactory, IOperationCommandFactory и их реализации (AccountCommandFactory, CategoryCommandFactory, OperationCommandFactory).

### Facade:

- Обоснование: Предоставляет унифицированный интерфейс к группе интерфейсов в подсистеме. Упрощает использование подсистемы, предоставляя высокоуровневый интерфейс.

- Реализация: AccountFacade, CategoryFacade, OperationFacade, AnalyticFacade.

### Strategy:

- Обоснование: Определяет семейство алгоритмов, инкапсулирует каждый из них и делает их взаимозаменяемыми. Позволяет изменять алгоритм независимо от клиентов, которые его используют.

- Реализация: DataImporter<T> (и его реализации: JsonImporter<T>, YamlImporter<T>, CsvImporter<T>) - стратегия импорта данных. IExportVisitor<T> (и его реализации: JsonExportVisitor<T>, YamlExportVisitor<T>, CsvExportVisitor<T>) - стратегия экспорта.

### Decorator:

- Обоснование: Динамически добавляет объекту новые обязанности. Является гибкой альтернативой порождению подклассов с целью расширения функциональности.

- Реализация: TimingCommandDecorator добавляет функциональность измерения времени выполнения к любой команде, реализующей интерфейс ICommand.
